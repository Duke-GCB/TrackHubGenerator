# TrackHubGenerator
Python and Make tools for generating UCSC Track Hubs. These can be added as custom data to both the [UCSC Genome Browser] and the [Ensembl browser].

The trackhub data generated can be found on [GCB's trackhub server]. At present, the code expects its input data in [BedGraph format].

[UCSC Genome Browser]: http://genome.ucsc.edu/cgi-bin/hgHubConnect
[Ensembl browser]: http://www.ensembl.org/
[GCB's trackhub server]: http://trackhub.genome.duke.edu/tf-dna-binding-predictions/
[BedGraph format]: https://genome.ucsc.edu/goldenpath/help/bedgraph.html

## Usage

This tool is designed to operate on directories of bed files, generated by [SVR_models](https://github.com/Duke-GCB/SVR_models). The bed files generated will be specific to a TF (e.g. E2F1 or E2F4) and a genome assembly (e.g. hg19 or hg38).

The tool expects a data directory structured as follows:

    data
    ├── hg19
    │   └── central20bp
    │       ├── E2F1
    │       │   ├── hg19-chr1-E2F1-central20bp-SVR-scores.bed
    │       │   ├── hg19-chr2-E2F1-central20bp-SVR-scores.bed
    │       │   ├── ...
    │       └── E2F4
    │           ├── hg19-chr1-E2F4-central20bp-SVR-scores.bed
    │           ├── hg19-chr2-E2F4-central20bp-SVR-scores.bed
    │           ├── ...
    ├── hg38
    │   └── central20bp
    │       ├── E2F1
    │       │   ├── hg38-chr1-E2F1-central20bp-SVR-scores.bed
    │       │   ├── hg38-chr2-E2F1-central20bp-SVR-scores.bed
    │       │   ├── ...
    │       └── E2F4
    │           ├── hg38-chr1-E2F4-central20bp-SVR-scores.bed
    │           ├── hg38-chr2-E2F4-central20bp-SVR-scores.bed
    │           ├── ...

To build the track hub, run `make`, specifying the path to the data directory as well as the desired output directory:

      make HUBROOT=/path/to/trackhub DATA=/path/to/data

You will need to install bedToBigBed, fetchChromSizes, python, and the python dependencies specified in [requirements.txt](python/requirements.txt).

Alternatively, this tool can be run with Docker. The included Dockerfile installs all necessary software. Build the image with `docker build -t dukegcb/trackhubgenerator .`, or pull from Docker hub with `docker pull dukegcb/trackhubgenerator`

To generate a track hub directory, run the docker image and specify the paths to your data:

    docker run \
      -v /path/to/data:/data:ro \
      -v /path/to/trackhub:/trackhub \
      dukegcb/trackhubgenerator

This image will run `make`, and produce a track hub directory, suitable for hosting on a web server.
